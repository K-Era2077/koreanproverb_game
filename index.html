<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>ì†ë‹´ Â· ê´€ìš©ì–´ ì›Œí¬ì‹œíŠ¸ ê²Œì„ (ëª¨ë°”ì¼)</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#121a33;
      --card2:#0f1630;
      --text:#e9eeff;
      --muted:rgba(233,238,255,.78);
      --line:rgba(255,255,255,.14);
      --ok:#2ecc71;
      --bad:#ff5c7a;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:
        radial-gradient(1100px 650px at 20% 0%, rgba(119,141,255,.22), transparent 60%),
        radial-gradient(900px 600px at 100% 30%, rgba(255,92,122,.16), transparent 55%),
        var(--bg);
      color:var(--text);
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;
      -webkit-font-smoothing:antialiased;
      text-rendering:optimizeLegibility;
    }
    .wrap{
      max-width:560px;
      margin:0 auto;
      padding:16px 14px calc(18px + env(safe-area-inset-bottom));
    }
    header{
      position:sticky;
      top:0;
      z-index:10;
      padding:14px 0 10px;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(11,16,32,.92), rgba(11,16,32,.68));
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    h1{
      margin:0 0 8px;
      font-size:17px;
      letter-spacing:-.3px;
      line-height:1.25;
    }
    .sub{
      margin:0 0 10px;
      color:var(--muted);
      font-size:12.5px;
      line-height:1.3;
    }
    .row{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      font-size:12.5px;
      color:rgba(233,238,255,.9);
    }
    select, button{
      font:inherit;
      color:var(--text);
      border:1px solid var(--line);
      background:rgba(255,255,255,.07);
      border-radius:14px;
      padding:12px 12px;
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
    }
    select{ padding:10px 12px; border-radius:12px; }
    button:active{ transform: translateY(1px); }
    .btn-primary{
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      border-color: rgba(255,255,255,.18);
    }

    .card{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(18,26,51,.55);
      border-radius:18px;
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
    }

    .stats{
      margin-top:10px;
      display:grid;
      grid-template-columns:1fr 1fr 1fr;
      gap:8px;
    }
    .stat{
      padding:10px 10px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      font-size:12.5px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .stat b{ font-size:13px; }

    .qbox{
      margin-top:12px;
      padding:16px 14px;
    }
    .qtitle{
      font-size:12.5px;
      color:var(--muted);
      margin-bottom:8px;
    }
    .qtext{
      font-size:18px;
      line-height:1.62;
      letter-spacing:-.2px;
      white-space:pre-wrap;
      word-break:keep-all;
    }

    .toast{
      margin-top:10px;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
      color: rgba(233,238,255,.92);
      font-size:13px;
      line-height:1.35;
    }
    .toast.ok{ border-color: rgba(46,204,113,.55); }
    .toast.bad{ border-color: rgba(255,92,122,.55); }

    /* ì„ íƒì§€: í•˜ë‹¨ ê³ ì • */
    .choices{
      position:sticky;
      bottom:0;
      z-index:9;
      margin-top:12px;
      padding:12px 0 calc(8px + env(safe-area-inset-bottom));
      background: linear-gradient(180deg, rgba(11,16,32,0), rgba(11,16,32,.92) 25%, rgba(11,16,32,.98));
    }
    .choice-grid{
      display:grid;
      gap:10px;
    }
    .opt{
      width:100%;
      text-align:left;
      padding:16px 14px;
      font-size:16.5px;
      line-height:1.2;
      border-radius:18px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.14);
    }
    .opt.ok{
      border-color: rgba(46,204,113,.75);
      background: rgba(46,204,113,.10);
    }
    .opt.bad{
      border-color: rgba(255,92,122,.75);
      background: rgba(255,92,122,.10);
    }

    .actions{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    .actions button{
      padding:14px 12px;
      font-size:15.5px;
      border-radius:16px;
    }

    .hint{
      margin-top:8px;
      color: rgba(233,238,255,.65);
      font-size:12px;
      line-height:1.35;
    }

    /* ì•„ì£¼ ì‘ì€ í™”ë©´ */
    @media (max-width:360px){
      .qtext{ font-size:17px; }
      .opt{ font-size:15.5px; padding:15px 12px; }
      .actions button{ font-size:15px; }
      .stats{ grid-template-columns:1fr 1fr; }
      .stat:nth-child(3){ grid-column:1 / -1; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ì†ë‹´ Â· ê´€ìš©ì–´ ì›Œí¬ì‹œíŠ¸ ê²Œì„</h1>
      <p class="sub">ëª¨ë°”ì¼ ì„¸ë¡œ í™”ë©´ ì „ìš© Â· ë³´ê¸° ì„ íƒí˜• / í”Œë˜ì‹œì¹´ë“œ</p>

      <div class="row">
        <span class="pill">ëª¨ë“œ
          <select id="mode" aria-label="ëª¨ë“œ ì„ íƒ">
            <option value="proverb">ì—°ìŠµ 1 â€” ì†ë‹´ ëœ» ë§íˆê¸°</option>
            <option value="idiom">ì—°ìŠµ 2 â€” ê´€ìš© í‘œí˜„ ì±„ìš°ê¸°</option>
            <option value="flash">í”Œë˜ì‹œì¹´ë“œ</option>
          </select>
        </span>

        <span class="pill">ë¬¸í•­
          <select id="count" aria-label="ë¬¸í•­ ìˆ˜">
            <option>5</option>
            <option selected>10</option>
            <option>12</option>
            <option>15</option>
            <option>20</option>
          </select>
        </span>

        <button class="btn-primary" id="start">ì‹œì‘ / ë‹¤ì‹œ ì‹œì‘</button>
      </div>

      <div class="stats">
        <div class="stat"><span>ì§„í–‰</span><b id="progress">0/0</b></div>
        <div class="stat"><span>ì ìˆ˜</span><b id="score">0</b></div>
        <div class="stat"><span>ì •ë‹µë¥ </span><b id="acc">0%</b></div>
      </div>
    </header>

    <main>
      <section class="card qbox" aria-live="polite">
        <div class="qtitle" id="qtitle">ë¬¸í•­</div>
        <div class="qtext" id="qtext">ìƒë‹¨ì—ì„œ ëª¨ë“œë¥¼ ê³ ë¥´ê³  â€œì‹œì‘ / ë‹¤ì‹œ ì‹œì‘â€ì„ ëˆŒëŸ¬ ì£¼ì„¸ìš”.</div>
      </section>

      <div class="toast" id="toast">ì•ˆë‚´: ë³´ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ ì •ë‹µì„ ì„ íƒí•˜ì„¸ìš”.</div>

      <section class="choices" aria-label="ì„ íƒì§€ ì˜ì—­">
        <div class="choice-grid" id="opts"></div>

        <div class="actions">
          <button id="reveal">ì •ë‹µ ë³´ê¸°</button>
          <button class="btn-primary" id="next">ë‹¤ìŒ</button>
        </div>

        <div class="hint">
          íŒ: íœ´ëŒ€í°ì—ì„œëŠ” ì„ íƒì§€ê°€ ì•„ë˜ì— ê³ ì •ë©ë‹ˆë‹¤. (ì—„ì§€ë¡œ ëˆ„ë¥´ê¸° í¸í•œ UI)
        </div>
      </section>
    </main>
  </div>

<script>
/* =========================
   ë°ì´í„° (ì›Œí¬ì‹œíŠ¸ ê¸°ë°˜)
   ========================= */

/* ì—°ìŠµ 1 ë³´ê¸°(ì†ë‹´) */
const PROVERBS = [
  "í˜¸ë‘ì´ë„ ì œ ë§ í•˜ë©´ ì˜¨ë‹¤",
  "ì†Œ ìƒê³  ì™¸ì–‘ê°„ ê³ ì¹œë‹¤",
  "ì„¸ ì‚´ ë²„ë¦‡ ì—¬ë“ ê¹Œì§€ ê°„ë‹¤",
  "ì›ìˆ­ì´ë„ ë‚˜ë¬´ì—ì„œ ë–¨ì–´ì§ˆ ë•Œê°€ ìˆë‹¤",
  "ì²œ ë¦¬ ê¸¸ë„ í•œ ê±¸ìŒë¶€í„°",
  "ê°œêµ¬ë¦¬ ì˜¬ì±™ì´ ì  ìƒê° ëª» í•œë‹¤",
  "ê³ ë˜ ì‹¸ì›€ì— ìƒˆìš° ë“± í„°ì§„ë‹¤",
  "ë¯¿ëŠ” ë„ë¼ì— ë°œë“± ì°íŒë‹¤",
  "ì Šì–´ì„œ ê³ ìƒì€ ì‚¬ì„œë„ í•œë‹¤",
  "ì‹œì‘ì´ ë°˜ì´ë‹¤"
];

/* ì—°ìŠµ 1 ë¬¸í•­(ì •ì˜ â†’ ì •ë‹µ ì†ë‹´) */
const PROVERB_QUESTIONS = [
  {
    prompt: "ìƒí™©ì´ ì˜›ë‚ ë³´ë‹¤ ë‚˜ì•„ì§„ ì‚¬ëŒì´ ìì‹ ì´ ì–´ë µë˜ ë•Œë¥¼ ìƒê°í•˜ì§€ ì•Šê³ \nì²˜ìŒë¶€í„° ì˜í–ˆë˜ ê²ƒì²˜ëŸ¼ í–‰ë™í•˜ëŠ” ê²ƒì„ í‘œí˜„í•˜ëŠ” ë§.",
    answer: "ê°œêµ¬ë¦¬ ì˜¬ì±™ì´ ì  ìƒê° ëª» í•œë‹¤"
  },
  {
    prompt: "ê°•í•œ ìë“¤ë¼ë¦¬ ì‹¸ìš°ëŠ” ë°”ëŒì— ì•„ë¬´ ê´€ê³„ë„ ì—†ëŠ” ì•½í•œ ìê°€\nì¤‘ê°„ì— ë¼ì–´ í”¼í•´ë¥¼ ì…ê²Œ ëœë‹¤ëŠ” ê²ƒì„ í‘œí˜„í•˜ëŠ” ë§.",
    answer: "ê³ ë˜ ì‹¸ì›€ì— ìƒˆìš° ë“± í„°ì§„ë‹¤"
  },
  {
    prompt: "ì¼ì´ ì´ë¯¸ ì˜ëª»ëœ ë’¤ì—ëŠ” í˜ì„ ì¨ë„ ì†Œìš©ì´ ì—†ë‹¤ëŠ” ê²ƒì„ í‘œí˜„í•˜ëŠ” ë§.",
    answer: "ì†Œ ìƒê³  ì™¸ì–‘ê°„ ê³ ì¹œë‹¤"
  },
  {
    prompt: "ì•„ë¬´ë¦¬ ìµìˆ™í•˜ê³  ì˜í•˜ëŠ” ì‚¬ëŒì´ë¼ë„ ê°€ë” ì‹¤ìˆ˜í•  ë•Œê°€ ìˆë‹¤ëŠ” ê²ƒì„ í‘œí˜„í•˜ëŠ” ë§.",
    answer: "ì›ìˆ­ì´ë„ ë‚˜ë¬´ì—ì„œ ë–¨ì–´ì§ˆ ë•Œê°€ ìˆë‹¤"
  },
  {
    prompt: "ì Šì—ˆì„ ë•Œ ê³ ìƒí•˜ëŠ” ê²ƒì€ ë¯¸ë˜ì˜ ë°œì „ì„ ìœ„í•˜ì—¬ ì¢‹ì€ ê²½í—˜ì´ ë˜ê¸° ë•Œë¬¸ì—\në„ˆë¬´ í˜ë“¤ê²Œ ìƒê°í•˜ì§€ ë§ë¼ëŠ” ê²ƒì„ í‘œí˜„í•˜ëŠ” ë§.",
    answer: "ì Šì–´ì„œ ê³ ìƒì€ ì‚¬ì„œë„ í•œë‹¤"
  },
  {
    prompt: "ë‹¤ë¥¸ ì‚¬ëŒì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ í•˜ëŠ”ë° ë°”ë¡œ ê·¸ ì‚¬ëŒì´ ë‚˜íƒ€ë‚˜ëŠ” ê²½ìš°ë¥¼ í‘œí˜„í•˜ëŠ” ë§.",
    answer: "í˜¸ë‘ì´ë„ ì œ ë§ í•˜ë©´ ì˜¨ë‹¤"
  }
];

/* ì—°ìŠµ 2 ë³´ê¸°(ê´€ìš© í‘œí˜„) */
const IDIOMS = [
  "ì…ì´ ê°€ë³ë‹¤",
  "ëˆˆì´ ë†’ë‹¤",
  "ì…ì´ ë¬´ê²ë‹¤",
  "ê·€ê°€ ì–‡ë‹¤",
  "ì…ì´ ì§§ë‹¤",
  "ë°œì´ ë„“ë‹¤"
];

/* ì—°ìŠµ 2 ë¬¸í•­(ëŒ€í™” â†’ ì •ë‹µ ê´€ìš© í‘œí˜„) */
const IDIOM_QUESTIONS = [
  {
    prompt:
`(ëŒ€í™” 1)
A: ì´ ì‹ë‹¹ ìŒì‹ì´ ì§„ì§œ ë§›ìˆëŒ€. ì—¬ê¸°ì„œ ë¨¹ì.
B: ê·¸ë˜? ë‚´ ì¹œêµ¬ëŠ” ê°€ê²©ì— ë¹„í•´ì„œ ë³„ë¡œë¼ê³  í•˜ë˜ë°.
A: ê·¸ë˜? ê·¸ëŸ¼ ë‹¤ë¥¸ ì‹ë‹¹ìœ¼ë¡œ ê°€ì.
B: ê·¸ëŸ°ë° ì–´ì œ ì‹ ë¬¸ì—ëŠ” ì´ ì‹ë‹¹ì´ ìµœê³ ë¼ê³  í–ˆê±°ë“ .
A: ê·¸ë ‡ì§€? ì—¬ê¸°ê°€ ë§›ìˆì„ ê±°ì•¼.

ì—¬ìëŠ”: ________`,
    answer: "ê·€ê°€ ì–‡ë‹¤"
  },
  {
    prompt:
`(ëŒ€í™” 2)
A: ì¹´ë©”ë¼ë¥¼ ì‚´ê¹Œ í•˜ëŠ”ë° ì–´ë–¤ ê²Œ ì¢‹ì„ì§€ ëª¨ë¥´ê² ë„¤.
B: ê·¸ë˜? ê·¸ëŸ¼ ë‚´ ì¹œêµ¬í•œí…Œ ë¬¼ì–´ë´ ì¤„ê²Œ. ì‚¬ì§„ì„ ì „ê³µìœ¼ë¡œ ê³µë¶€í•˜ëŠ” ì¹œêµ¬ê°€ ìˆì–´.
A: ì¹´ë©”ë¼ ì‚¬ë©´ ê¸°ë…ìœ¼ë¡œ ê°™ì´ ì—¬í–‰ ê°€ì. ì–´ë•Œ?
B: ì¢‹ì€ ìƒê°ì´ì•¼. ì—¬í–‰ì‚¬ì— ê·¼ë¬´í•˜ëŠ” ì¹œêµ¬ê°€ ìˆëŠ”ë° ì–´ë””ê°€ ì¢‹ì€ì§€ ë¬¼ì–´ë³¼ê²Œ.

ì—¬ìëŠ”: ________`,
    answer: "ë°œì´ ë„“ë‹¤"
  },
  {
    prompt:
`(ëŒ€í™” 3)
A: ì§„ìš°ì™€ ì„¸ê²½ì´ê°€ í—¤ì–´ì¡Œë‹¤ë˜ë° ì™œ í—¤ì–´ì¡ŒëŠ”ì§€ ì•Œì§€?
B: ì•„ë‹ˆ.
A: ë„ˆ ì„¸ê²½ì´í•˜ê³  ì œì¼ ì¹œí•˜ì–ì•„. ì™œ ê·¸ë¬ëŒ€?
B: ëª°ë¼. ë°”ë¹ ì„œ ë¨¼ì € ê°ˆê²Œ.

ì—¬ìëŠ”: ________`,
    answer: "ì…ì´ ë¬´ê²ë‹¤"
  },
  {
    prompt:
`(ëŒ€í™” 4)
A: ê³ ê¸° ì¢€ ë” ë¨¹ì§€ ê·¸ë˜?
B: ì˜¤ëŠ˜ì€ ê³ ê¸°ê°€ ë³„ë¡œ ë¨¹ê³  ì‹¶ì§€ ì•Šë„¤.
A: ë°¥ì€ ì™œ ì´ë ‡ê²Œ ì¡°ê¸ˆ ë¨¹ì–´?
B: ë°°ê°€ ë¶ˆëŸ¬ì„œ ê·¸ë§Œ ë¨¹ê³  ì‹¶ì–´.

ì—¬ìëŠ”: ________`,
    answer: "ì…ì´ ì§§ë‹¤"
  },
  {
    prompt:
`(ëŒ€í™” 5)
A: ì–´ë–»ê²Œ ê·¸ëŸ´ ìˆ˜ê°€ ìˆì–´? ì§„ìš°ëŠ” ë‚˜ë¥¼ ì§œì¦ë‚˜ê²Œ í•œë‹¤ê³  ë§í•œ ê±¸ ë„¤ê°€ ì§„ìš°í•œí…Œ ë‹¤ ë§í–ˆë‹¤ë©´ì„œ?
B: ì–´, ê·¸ê²Œâ€¦ ë¯¸ì•ˆ.
A: ë‚˜ëŠ” ë„ˆë¥¼ ë¯¿ê³  í•œ ë§ì´ì—ˆëŠ”ë°.
B: ë¯¸ì•ˆí•´. ê·¸ëŸ°ë° ì´ê±´ ë¹„ë°€ì¸ë° ì§„ìš°ë„ ëˆˆì¹˜ ì—†ëŠ” ë„¤ ì„±ê²©ì´ ë§˜ì— ì•ˆ ë“ ë‹¤ê³  í–ˆì–´.

ì—¬ìëŠ”: ________`,
    answer: "ì…ì´ ê°€ë³ë‹¤"
  },
  {
    prompt:
`(ëŒ€í™” 6)
A: ì´ë²ˆì— ë‚´ê°€ ì†Œê°œí•´ ì¤€ ì‚¬ëŒ ì–´ë•Œ? ê´œì°®ì§€?
B: ë³„ë¡œì˜€ì–´. í‚¤ê°€ ë„ˆë¬´ í¬ê³  ë§ì´ ë§ì•„ì„œ í”¼ê³¤í–ˆì–´.
A: ë¬´ìŠ¨ ì†Œë¦¬ì•¼. ì§€ë‚œë²ˆì— ì†Œê°œí•´ ì¤€ ì‚¬ëŒì€ í‚¤ê°€ ì‘ê³  ë§ì´ ë³„ë¡œ ì—†ë‹¤ê³  ì‹«ë‹¤ê³  í–ˆì–ì•„.
B: ì–´ì¨Œë“  ì´ë²ˆì— ë§Œë‚œ ì‚¬ëŒë„ ë§ˆìŒì— ì•ˆ ë“œë„¤. ì¢€ ë” ë©‹ìˆê³  ë˜‘ë˜‘í•œ ì‚¬ëŒ ì—†ì„ê¹Œ?

ì—¬ìëŠ”: ________`,
    answer: "ëˆˆì´ ë†’ë‹¤"
  }
];

/* =========================
   ìœ í‹¸
   ========================= */
const $ = (sel) => document.querySelector(sel);

function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
function pickN(arr,n){
  return shuffle(arr).slice(0, Math.min(n, arr.length));
}
function pct(n,d){ return d===0 ? 0 : Math.round((n/d)*100); }

/* =========================
   ìƒíƒœ
   ========================= */
let deck = [];
let idx = 0;
let score = 0;
let correct = 0;
let answered = 0;
let locked = false;
let currentCorrect = "";
let currentChoices = [];
let flashFlipped = false;

/* =========================
   UI helpers
   ========================= */
function setToast(text, kind=""){
  const t = $("#toast");
  t.innerHTML = text;
  t.classList.remove("ok","bad");
  if(kind) t.classList.add(kind);
}
function updateStats(){
  $("#progress").textContent = deck.length ? `${Math.min(idx+1, deck.length)}/${deck.length}` : "0/0";
  $("#score").textContent = ($("#mode").value==="flash") ? "-" : String(score);
  $("#acc").textContent = ($("#mode").value==="flash") ? "-" : `${pct(correct, answered)}%`;
}
function clearChoices(){
  $("#opts").innerHTML = "";
}

/* =========================
   ë Œë”
   ========================= */
function render(){
  const mode = $("#mode").value;

  if(deck.length === 0){
    $("#qtitle").textContent = "ë¬¸í•­";
    $("#qtext").textContent = "ìƒë‹¨ì—ì„œ ëª¨ë“œë¥¼ ê³ ë¥´ê³  â€œì‹œì‘ / ë‹¤ì‹œ ì‹œì‘â€ì„ ëˆŒëŸ¬ ì£¼ì„¸ìš”.";
    clearChoices();
    setToast("ì•ˆë‚´: ì‹œì‘ ë²„íŠ¼ì„ ëˆŒëŸ¬ ê²Œì„ì„ ì‹œì‘í•˜ì„¸ìš”.");
    updateStats();
    return;
  }

  if(idx >= deck.length){
    $("#qtitle").textContent = "ê²°ê³¼";
    if(mode === "flash"){
      $("#qtext").textContent = "ë! â€œì‹œì‘ / ë‹¤ì‹œ ì‹œì‘â€ìœ¼ë¡œ ë‹¤ì‹œ ì„ì„ ìˆ˜ ìˆì–´ìš”.";
      clearChoices();
      setToast("ì™„ë£Œ!", "ok");
    }else{
      // ê²°ê³¼ í™”ë©´(í€´ì¦ˆ ëª¨ë“œ)
      const perfectProverb = (mode === "proverb" && deck.length === 6 && correct === 6 && answered === 6);
      if(perfectProverb){
        $("#qtext").innerHTML =
`ğŸ‰ <b>ì¶•í•˜í•©ë‹ˆë‹¤!</b> ì—°ìŠµ 1 (ì†ë‹´ ëœ» ë§íˆê¸°) <b>6ë¬¸ì œ</b>ë¥¼ ëª¨ë‘ ë§í˜”ì–´ìš”!<br><br>
ì´ì œ <b>ëª¨ë“œ</b>ê°€ ë” ìˆë‹¤ëŠ” ê±¸ ê¸°ì–µí•˜ì„¸ìš” ğŸ‘‡<br>
<b>ì—°ìŠµ 2 â€” ê´€ìš© í‘œí˜„ ì±„ìš°ê¸°</b>ì— ë„ì „í•´ ë³¼ê¹Œìš”?<br><br>
<button id="go2" class="btn-primary" style="width:100%; padding:14px 12px; border-radius:16px; font-size:15.5px;">
ì—°ìŠµ 2ë¡œ ë„ì „í•˜ê¸° â†’
</button>
<div style="margin-top:10px; color: rgba(233,238,255,.7); font-size:12.5px; line-height:1.35;">
(ë˜ëŠ” ìœ„ì˜ <b>ëª¨ë“œ</b>ì—ì„œ <b>ì—°ìŠµ 2</b>ë¥¼ ì§ì ‘ ì„ íƒí•´ë„ ë©ë‹ˆë‹¤)
</div>`;
        setToast("ì™„ë²½í•´ìš”! ì´ì œ ì—°ìŠµ 2ë¡œ ë„˜ì–´ê°€ ë³¼ê¹Œìš”?", "ok");
        // ë²„íŠ¼ ì´ë²¤íŠ¸(ë Œë” ì§í›„ ë¶™ì´ê¸°)
        setTimeout(() => {
          const btn = document.getElementById("go2");
          if(btn){
            btn.addEventListener("click", () => {
              $("#mode").value = "idiom";
              buildDeck();
              render();
            });
          }
        }, 0);
      }else{
        $("#qtext").textContent =
`ë!

- ì ìˆ˜: ${score}
- ì •ë‹µ: ${correct} / ${answered} (${pct(correct, answered)}%)

â€œì‹œì‘ / ë‹¤ì‹œ ì‹œì‘â€ìœ¼ë¡œ ë‹¤ì‹œ í’€ ìˆ˜ ìˆì–´ìš”.`;
      }
      clearChoices();
      setToast("ì™„ë£Œ! ë‹¤ì‹œ í•˜ë ¤ë©´ ì‹œì‘ì„ ëˆ„ë¥´ì„¸ìš”.", "ok");
    }
    updateStats();
    return;
  }

  const q = deck[idx];
  $("#qtitle").textContent = q.title;
  $("#qtext").textContent = q.prompt;

  clearChoices();
  locked = false;
  flashFlipped = false;

  currentCorrect = q.answer;
  currentChoices = q.choices;

  currentChoices.forEach((c, i) => {
    const b = document.createElement("button");
    b.className = "opt";
    b.textContent = `${i+1}. ${c}`;
    b.addEventListener("click", () => onChoose(i));
    $("#opts").appendChild(b);
  });

  if(mode === "flash"){
    setToast("í”Œë˜ì‹œì¹´ë“œ: 1ë²ˆ(ë’¤ì§‘ê¸°) â†’ 2ë²ˆ(ë‹¤ìŒ) ìˆœì„œë¡œ ì‚¬ìš©í•˜ì„¸ìš”.");
  }else{
    setToast("ë³´ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ ì •ë‹µì„ ì„ íƒí•˜ì„¸ìš”.");
  }

  updateStats();
}

function onChoose(i){
  const mode = $("#mode").value;

  // flash mode
  if(mode === "flash"){
    if(i === 0){
      if(flashFlipped) return;
      flashFlipped = true;
      $("#qtext").textContent = currentCorrect + "\n\n(ì´ì œ 2ë²ˆ 'ë‹¤ìŒìœ¼ë¡œ'ë¥¼ ëˆŒëŸ¬ ì£¼ì„¸ìš”)";
      const btns = Array.from(document.querySelectorAll(".opt"));
      btns[0].classList.add("ok");
      setToast("ì¹´ë“œë¥¼ ë’¤ì§‘ì—ˆìŠµë‹ˆë‹¤.", "ok");
      return;
    }
    if(i === 1){
      next();
      return;
    }
    return;
  }

  // quiz modes
  if(locked) return;
  locked = true;
  answered++;

  const picked = currentChoices[i];
  const btns = Array.from(document.querySelectorAll(".opt"));

  // í‘œì‹œ: ì •ë‹µì€ í•­ìƒ ì´ˆë¡
  btns.forEach((b, k) => {
    if(currentChoices[k] === currentCorrect) b.classList.add("ok");
  });

  if(picked === currentCorrect){
    correct++;
    score += 10;
    btns[i].classList.add("ok");
    setToast(`ì •ë‹µ! <b>${currentCorrect}</b>`, "ok");
  }else{
    score -= 3;
    btns[i].classList.add("bad");
    setToast(`í‹€ë ¸ì–´ìš”. ì •ë‹µì€ <b>${currentCorrect}</b>`, "bad");
  }

  updateStats();
}

/* =========================
   ë± ìƒì„±
   ========================= */
function buildDeck(){
  const mode = $("#mode").value;
  const cnt = parseInt($("#count").value,10);

  idx = 0;
  score = 0;
  correct = 0;
  answered = 0;

  if(mode === "proverb"){
    const qs = pickN(PROVERB_QUESTIONS, cnt);
    deck = qs.map((q, n) => {
      const wrongPool = PROVERBS.filter(x => x !== q.answer);
      const choices = shuffle([q.answer, ...pickN(wrongPool, 3)]);
      return { title:`ì—°ìŠµ 1 Â· ì†ë‹´ ëœ» ë§íˆê¸° (${n+1})`, prompt:q.prompt, answer:q.answer, choices };
    });
  }else if(mode === "idiom"){
    const qs = pickN(IDIOM_QUESTIONS, cnt);
    deck = qs.map((q, n) => {
      const wrongPool = IDIOMS.filter(x => x !== q.answer);
      const choices = shuffle([q.answer, ...pickN(wrongPool, 3)]);
      return { title:`ì—°ìŠµ 2 Â· ê´€ìš© í‘œí˜„ ì±„ìš°ê¸° (${n+1})`, prompt:q.prompt, answer:q.answer, choices };
    });
  }else{
    // flash: ì†ë‹´(ì•=í‘œí˜„, ë’¤=ì •ì˜) + ê´€ìš©(ì•=í‘œí˜„, ë’¤=ëŒ€í™”)
    const cards = [];
    PROVERB_QUESTIONS.forEach(q => cards.push({ front:q.answer, back:q.prompt }));
    IDIOM_QUESTIONS.forEach(q => cards.push({ front:q.answer, back:q.prompt.replace(/\nì—¬ìëŠ”: ________$/,"").trim() }));

    const chosen = pickN(cards, cnt);
    deck = chosen.map((c, n) => ({
      title:`í”Œë˜ì‹œì¹´ë“œ (${n+1})`,
      prompt: c.front + "\n\n(1ë²ˆ: ë’¤ì§‘ê¸° / 2ë²ˆ: ë‹¤ìŒìœ¼ë¡œ)",
      answer: c.back,
      choices: ["ë’¤ì§‘ê¸°", "ë‹¤ìŒìœ¼ë¡œ"]
    }));
  }
}

/* =========================
   ì•¡ì…˜
   ========================= */
function next(){
  idx++;
  render();
}
function reveal(){
  const mode = $("#mode").value;
  if(mode === "flash"){
    setToast("í”Œë˜ì‹œì¹´ë“œëŠ” 1ë²ˆ â€˜ë’¤ì§‘ê¸°â€™ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.");
    return;
  }
  if(deck.length === 0 || idx >= deck.length) return;

  setToast(`ì •ë‹µ: <b>${currentCorrect}</b>`);
  const btns = Array.from(document.querySelectorAll(".opt"));
  btns.forEach((b, k) => {
    if(currentChoices[k] === currentCorrect) b.classList.add("ok");
  });
}

/* =========================
   ì´ë²¤íŠ¸
   ========================= */
$("#start").addEventListener("click", () => {
  buildDeck();
  render();
});
$("#next").addEventListener("click", () => {
  if(deck.length===0) return;
  next();
});
$("#reveal").addEventListener("click", reveal);

/* í‚¤ë³´ë“œ(PCì—ì„œë„ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥) */
document.addEventListener("keydown", (e) => {
  const key = e.key.toLowerCase();
  if(key === "n") next();
  if(["1","2","3","4"].includes(e.key)){
    const i = parseInt(e.key,10)-1;
    const btns = document.querySelectorAll(".opt");
    if(btns[i]) btns[i].click();
  }
});

/* ì´ˆê¸° */
render();
</script>
</body>
</html>
